# {
#     "departments": [
#         "消防",
#         "医院",
#         "安保",
#         "物业"
#     ],
#     "timeline": [
#         {
#             "time": "08:30-08:40",
#             "消防": {
#                 "name": "到场火情侦查与初步布控",
#                 "detail": "迅速到达现场，侦查火源、火势、被困位置；布置主水带扑救明火，划定警戒区，与物业核对被困人数及楼栋结构，制定灭火与救人分工。"
#             },
#             "医院": {
#                 "name": "医疗点布局与急救准备",
#                 "detail": "在安全区外设立临时医疗接收点，准备急救设备，组员与消防实时沟通救援进展，做好多名伤员急救和转院准备。"
#             },
#             "安保": {
#                 "name": "疏散指引与秩序维护",
#                 "detail": "启动应急广播，按疏散演练路线引导居民下楼避险，封锁非安全通道、电梯、车库，维持疏散区秩序，确保救援通道畅通，协同消防、医疗组信息流通。"
#             },
#             "物业": {
#                 "name": "住户信息及结构资料支持、物资调配",
#                 "detail": "整理并分发详尽居民名单和楼栋结构图，协助消防精准定位被困人员，调配防烟面罩、湿毛巾等物资送至出口，实时动态清点人数。"
#             }
#         },
#         {
#             "time": "08:40-09:00",
#             "消防": {
#                 "name": "集中灭火救人与排烟",
#                 "detail": "主攻二楼厨房明火，分队携带呼吸器分两路入楼救人，并实施排烟与通风。全楼逐房排查，及时救出生还3人后通知医疗组及物业更新名单。"
#             },
#             "医院": {
#                 "name": "现场急救与分级转运",
#                 "detail": "及时接收救出伤员，实施检伤分级、吸氧、烧伤处置、生命支持，对重伤员优先带绿色通道转院，安抚家属与完善伤员台账。"
#             },
#             "安保": {
#                 "name": "安全转运伤员与通道巡查",
#                 "detail": "护送医护与伤员至医疗点，清理救援与疏散通道障碍，控制围观，严禁非工作人员靠近火灾区，多方协调确保身份和流线无误。"
#             },
#             "物业": {
#                 "name": "实时信息更新与防护物资增补",
#                 "detail": "更新并上报被困和疏散名单，补充防烟口罩、湿毛巾等至警戒区外出口，支援救援一线，适时追加物资供应。"
#             }
#         },
#         {
#             "time": "09:00-09:30",
#             "消防": {
#                 "name": "全面搜查与隐患排查",
#                 "detail": "全楼逐房核查，热成像与测温仪查找暗火、余火，联动物业排查管井、楼梯间和邻楼，强化排烟，实时通报信息，确认无新增被困人员。"
#             },
#             "医院": {
#                 "name": "持续医疗观察与批次转运",
#                 "detail": "根据现场纠正新获救伤员，分类分批转运，补充急救物资，对特殊人群重点医疗，家属对接和信息公告，内部分区运行规范。"
#             },
#             "安保": {
#                 "name": "疏散区查验与通道控制",
#                 "detail": "协查疏散名单，配合逐户核实去向，巡逻维护警戒区与进出口，防范居民回返火场与聚集，安抚情绪激动人员，保持秩序。"
#             },
#             "物业": {
#                 "name": "断供与安全监测",
#                 "detail": "全面断电、断气、断民用水，重点检测燃气泄漏、防次生灾害，协助信息通报与系统操作，保障消防与医护安全。"
#             }
#         },
#         {
#             "time": "09:30-10:00",
#             "消防": {
#                 "name": "余火扑灭与火场清理",
#                 "detail": "二次喷水、拆检橱柜墙体找暗火，红外测温彻查无复燃风险，联合物业排查所有房间角落，确认无残留火情，准备安全移交。"
#             },
#             "医院": {
#                 "name": "终极伤员筛查与转运",
#                 "detail": "核查伤员、确认名单，复查所有现场、疏散点，重点筛查老人、儿童等，完成需进一步治疗者批次转运及家属安抚。"
#             },
#             "安保": {
#                 "name": "终轮身份核查与运输秩序控制",
#             },
#             "物业": {
#                 "name": "名单终校、家属对接与后勤延续",
#                 "detail": "逐一核查疏散与伤员名单，通知安置、协助安抚家属，保障物资、场地持续供应，信息公告与咨询专员上岗。"
#             }
#         },
#         {
#             "time": "10:00-10:30",
#             "消防": {
#                 "name": "火场安全评估与正式移交",
#                 "detail": "技术组与物业逐项核查被烧区域，检测高温点、确认结构安全，完成现场报告，召集物业及公安完成现场交接，继续外围警戒支持。"
#             },
#             "医院": {
#                 "name": "医疗组撤离与装备整理",
#                 "detail": "与指挥官确认救援终止，收整所有医疗器械及物资，信息台账移交，听从后续现场留守或撤离安排。"
#             },
#             "安保": {
#                 "name": "善后秩序管理与入口控制",
#                 "detail": "维持外围警戒带，协助事故调查与归档，巩固出入台账，疏导居民前往临时安置区，配合专业队伍火场清理、善后安抚。"
#             },
#             "物业": {
#                 "name": "全面安置、清理与公益公告",
#                 "detail": "开放临时安置区提供各类物资和信息服务，启动受灾区域清理、灾损统计及环境恢复，公告事故详情、开展灾后心理疏导及保险指引，与消防协同持续反馈善后进展。"    
#             }
#         }
#     ]
# }


import json
import requests

# 测试用的固定 JSON 数据
# test_payload = {
#     "departments": ["消防", "医院", "安保", "物业"],
#     "timeline": [
#         {
#             "time": "08:30-08:40",
#             "actions": {
#             "消防": {"name": "测试任务1", "detail": "测试任务详情1"},
#             "医院": {"name": "测试任务2", "detail": "测试任务详情2"},
#             "安保": {"name": "测试任务3", "detail": "测试任务详情3"},
#             "物业": {"name": "测试任务4", "detail": "测试任务详情4"},
#             }
#         }
#     ]
# }

test_payload = {
    "departments": [
        "消防",
        "医院",
        "安保",
        "物业"
    ],
    "timeline": [
        {
            "time": "08:30-08:40",
            "actions": {
                "消防": {
                    "name": "现场侦查与作战布置",
                    "detail": "第一梯队消防员佩戴空呼、防火服用对讲机迅速侦查火情边界，利用物业提供的人员名单定位被困人员。部署主战车及水带，因风力大确定从下风侧夹击火源，协调警戒线布置。"
                },
                "医院": {
                    "name": "急救点搭建与器械准备",
                    "detail": "医护人员在火场安全区域（避开下风口和烟雾）搭建急救帐篷，准备氧气、烧伤及吸入毒物救治用品，为接收伤员做准备，并全部穿戴防护装具。"
                },
                "安保": {
                    "name": "警戒线设置与秩序维护",
                    "detail": "保安在楼宇外围和消防通道张贴警戒线并把守主干道、出入口，启动社区应急广播，指引居民有序撤离，严禁无关人员进入火场周边。"
                },
                "物业": {
                    "name": "人员信息与资源对接",
                    "detail": "调取3号楼住户名单及结构信息，统计确认疑似被困人员并实时更新，发给消防前线指挥。开放消防栓、检查供水水压，打通疏散与救援通道，随时准备切断电源。"  
                }
            }
        },
        {
            "time": "08:40-08:50",
            "actions": {
                "消防": {
                    "name": "主攻灭火与被困者搜救",
                    "detail": "两条主战水枪水带顺风夹击明火区，上风侧设警戒人防止火势回卷。用红外热成像仪定位被困人员，组织分队按重点顺序进入烟雾密集和有呼救声区域进行救援。"   
                },
                "医院": {
                    "name": "伤员评估与吸入伤初步处置",
                    "detail": "对首批救出的吸入伤及烧伤人员实施高流量吸氧及气道监测，对严重者准备气管插管。分诊重症伤员，准备120急救车辆转运。"
                },
                "安保": {
                    "name": "二次疏散与重点人群协助",
                    "detail": "配合物业和社区志愿者沿疏散通道巡查，专人协助老人、儿童等特殊群体转移到安全区，并维持外围秩序，防止人群回流。"
                },
                "物业": {
                    "name": "应急广播与救援支援",
                    "detail": "持续广播疏散要点，物业工程部待命随时供水并随消防请求切断电源。协助消防组调运担架、水源并协助急救点建立。"
                }
            }
        },
        {
            "time": "08:50-09:10",
            "actions": {
                "消防": {
                    "name": "深入搜救与排烟防护",
                    "detail": "组建救援分队，携带隔热毯、担架深入火场，持续搜救其余被困者，使用正压风机强排烟雾，重点保护搜救路线不被后续火势封堵，随时通报情报动态。"
                },
                "医院": {
                    "name": "医疗救治与重伤转运",
                    "detail": "对已救出伤员进行进一步伤情分级，烧伤者实施冷敷、包扎、补液，严重病例优先用急救车送往医院，轻伤留守临时医疗点观察并记录用药和症状。"
                },
                "安保": {
                    "name": "疏散区秩序与围观人控制",
                    "detail": "加强疏散区防控，清点人员，组织志愿者协助后勤，及时劝导围观人群远离，为消防和医护留出最大救援空间，同时协助伤员搬运。"
                },
                "物业": {
                    "name": "临时安置与信息核查",
                    "detail": "引导受灾居民至指定避险点，发放应急饮用水和生活必需品，并协助安保对人员清点，防止有居民遗漏未撤离。"
                }
            }
        },
        {
            "time": "09:10-10:00",
            "actions": {
                "消防": {
                    "name": "残火压制与余下搜救",
                    "detail": "继续对难以接近火点实施夹攻压制，排查所有房间，确保无人员被困，重点监控风向变化对火势的影响，并按现场实际再部署力量。"
                },
                "医院": {
                    "name": "持续医疗观察与心理干预",
                    "detail": "为轻症和观察期人员进行复查、吸氧和创面处理，对受惊吓或焦虑者进行心理安抚及基础干预，继续配合急救转运服务。"
                },
                "安保": {
                    "name": "外围巡查与救援协作",
                    "detail": "维护警戒区，辅助医护和消防人员搬运器材和伤员，防止各类车辆和无关人员进入，协助物业统计最终撤离人员名单。"
                },
                "物业": {
                    "name": "后勤保障与现场配合",
                    "detail": "持续为救援提供水源、备用电和物资补给，与各部门保持无线联络，随时响应新指令，安排志愿者协助安置受灾居民。"
                }
            }
        },
        {
            "time": "10:00-10:30",
            "actions": {
                "消防": {
                    "name": "现场排查与安全解封",
                    "detail": "灭火结束后组织全楼房间复查，确认余火、暗火彻底清除；检测瓦斯泄漏风险，核实现场安全，再通知物业和警戒解除。"
                },
                "医院": {
                    "name": "收尾处置与伤员交接",
                    "detail": "完成医疗记录、整理急救用物，协助转运剩余伤员至医院或临时安置点，向物业和家属反馈人员健康情况。"
                },
                "安保": {
                    "name": "现场解封与秩序恢复",
                    "detail": "解除外围警戒线，引导社区居民有序返回，制止现场遗留围观，全面协助相关部门恢复小区秩序。"
                },
                "物业": {
                    "name": "善后安置与隐患排查",
                    "detail": "协助消防全面复查楼宇安全, 配合消防/安保安排居民返家。整理善后资料，跟进维修及清理，继续为社区提供心理及生活支援。"
                }
            }
        }
    ]
}


# 打印将发送至后端的数据
print("即将发送至后端的测试数据:")
print(json.dumps(test_payload, ensure_ascii=False, indent=4))

# 向 Spring Boot 后端发送测试数据
url1 = "http://localhost:8080/api/ai-assistant/receive-fire-response"
url2 = "http://localhost:8080/api/get-timeline-response"

print("=======================================")

try:
    response = requests.post(url1, json=test_payload)

    # 打印后端响应内容
    if response.status_code == 200:
        print("后端响应:")
        print(response.text)
    else:
        print(f"传输失败，状态码: {response.status_code}")
        print("响应内容:")
        print(response.text)
except requests.RequestException as e:
    print(f"请求失败: {e}")

print("=======================================")

try:
    response = requests.post(url2, json=test_payload)

    # 打印后端响应内容
    if response.status_code == 200:
        print("后端响应:")
        print(response.text)
    else:
        print(f"传输失败，状态码: {response.status_code}")
        print("响应内容:")
        print(response.text)
except requests.RequestException as e:
    print(f"请求失败: {e}")